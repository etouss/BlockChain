%!TEX root = main.tex

An attempt to give the most abstract possible definition of a blockchain.

\section{BlockChain}
Given a set $S$, let $\flist(S)$ and $\fset(S)$ be the sets of all finite lists and all finite sets of elements of $S$, respectively. Given $L \in \flist(S)$, we use notation $|L|$ to refer to the number of elements in $L$, and notation $L[i]$ to refer to the $i$-th element in $L$, where $i \in \{1, \ldots, |L|\}$. From now on, assume that $\Sigma$ is a finite alphabet, and that $\B \subseteq \Sigma^*$ is the set of all possible blocks.  Moreover we extend the definition of $\subseteq$ such that :
\begin{eqnarray*}
	\forall S \in \fset(B), \forall L \in \flist(B), L \subseteq S \Leftrightarrow \forall i \in \{1, \ldots, |L|\}, L[i] \in S
\end{eqnarray*}

\begin{mydef}
A validation rule is a function $V : \flist(\B) \to \fset(\B)$
\end{mydef}
Intuitively $V$ is a function taking a list $L$ of block as input, and returning the set of blocks that could be added to $L$ to produce a valid blockchain.

\begin{mydef}
Let $G \in \flist(\B)$ be non-empty, and $V$ be a validation rule. Then a list $L \in \flist(\B)$ is a validated chain with respect to $(G,V)$ if:
\begin{enumerate}
\item $|G| \leq |L|$ and $L[i] = G[i]$, for every $i \in \{1, \ldots, |G|\}$.

\item $L[1] \in V([\ ])$ and $L[i+1] \in V([L[1], \ldots, L[i]])$, for every $i \in \{1, \ldots, |L|-1\}$.
\end{enumerate}
\end{mydef}
List $L$ in this definition is a valid chain according to the validation rule $V$ and the lists $G$ of genesis blocks (whose role is to provide the blocks to startup the system). Let $\LOG(G,V)$ be the set of validated chains with respect to $(G,V)$.

%\begin{myrem}
%	We introduce $LOG_{G,V}$ which really complicated but is actually necessary to deal with fork and consensus later.
%\end{myrem}
%
%\begin{mydef}
%	A set of validated chain $LOG_{G,V}$ is said to be infinite if:
%	$$\forall log_{G,V} \in LOG_{G,V}, \forall i \in \mathbb{N} , \forall b  \in V(log_{G,V}(i)-), V(log_{G,V}(i)-,b)\neq \emptyset $$
%\end{mydef}
%
%\begin{myrem}
%	Infinite here is used in a sense that whatever instance of a $G,V$ validated-chain we are dealing with we will always be able to complete it.
%\end{myrem}

\begin{mydef}
Let $G \in \flist(\B)$ be non-empty, and $V$ be a validation rule. Then $\LOG(G,V)$ is safe if for every $L \in \LOG(G,V)$ such that every $b_1, b_2 \in \B$ such that $b_1 \neq b_2$:
\begin{eqnarray*}
V([L[1], \ldots, L[|L|], b_1]) \cap V([L[1], \ldots, L[|L|], b_2]) & = & \emptyset
\end{eqnarray*}
\end{mydef}
Intuitively, in order to be secured $V$ should depend on the last block $b$ that is included in the blockchain.

\begin{mydef}
Let $P$ be a set of players and $K_T$ a function :
$$K_{T} : P \times \llbracket 0;T \rrbracket \times \mathbb{N} \rightarrow \fset(\B \times [0;1])$$ 
Then $(P,K_{T})$ is a valid knowledge representation if :

\begin{eqnarray*}
&\forall p \in P,\forall t\in \llbracket 0;T \rrbracket, (b,\alpha) \in K_{T}(t,0,p) \implies \alpha = 1 \lor \alpha = 0\\
&\forall p \in P,\forall t,t'\in \llbracket 0;T \rrbracket, t' \geq t, \forall b \in \B,  (b,1) \in K_{T}(t,0,p) \implies (b,1) \in K(t',0,p)  \\
&\forall p \in P,\forall t\in \llbracket 0;T \rrbracket, \forall \delta \in \mathbb{N}, \forall b \in \B,  (b,1) \in K_{T}(t,0,p) \implies (b,1) \in K(t,\delta,p) \\
&\forall p \in P,\forall t\in \llbracket 0;T \rrbracket, \forall \delta,\delta' \in \mathbb{N}, \delta' \geq \delta \implies \forall (b,\alpha) \in K_{T}(p,t,\delta), \exists (b,\alpha') \in K_{T}(p,t,\delta'), \alpha'\geq \alpha\\
\end{eqnarray*}
\end{mydef}

\begin{mynota}
	$\forall p \in P, \forall t\in \llbracket 0;T \rrbracket$ we denote $$K_{T}(p,t)=\{b | (b,1) \in K_{T}(p,t,0)\}$$
\end{mynota}

\begin{mydef}
	Let $T,T' \in \mathbb{N}$ such that $T>T'$ we say that $K'_{T'}$ extend $K_{T}$ if $$\forall p, K_{T}(p,T) = K'_{T'}(p,T)$$
\end{mydef}

\begin{mydef}
	Let $\preceq_{G,V,t}$ be  a total preorder over $LOG_{G,V}$:
\begin{eqnarray*}		
	&\forall L_1, L_2, L_3 \in LOG_{G,V}, L_1 \preceq_{G,V,t} L_2 \land L_2 \preceq_{G,V,t} L_3 \implies L_1 \preceq_{G,V,t} L_3  \\
	&\forall L_1, L_2 \in LOG_{G,V}, L_1 \preceq_{G,V,t} L_2 \lor L_2 \preceq_{G,V,t} L_1 
\end{eqnarray*}
	A block chain protocol over $LOG_{G,V}$ is a function noted $\preceq_{G,V}$ such that: $$ \forall t \in \mathbb{N}, \preceq_{G,V}(t) =  \preceq_{G,V,t}$$ where $\preceq_{G,V,t}$ is a total preorder over $LOG_{G,V}$
\end{mydef}
\begin{myrem}
	$\preceq_{G,V}$ can be seen as the rules in case of fork and new block. 
\end{myrem}

\begin{mydef}
	Considering $LOG_{G,V}$ the set of validated chains with respect to $(G,V)$, $(P,K_T)$ a valid knowledge representation and $\preceq_{G,V}$ a block chain protocol. We denote $S_{t,p}$ where $t\in \llbracket0,T\rrbracket$ and $p\in P$ the set:
	$$ S_{t,p} = \{L | L \in LOG_{G,V} \land  L \subseteq K_T(p,t)\} $$
	
	We call a BlockChain at time $t\in \llbracket0,T\rrbracket$ for user $p \in P$ noted $BC_{t,p}$ a list such that:
	$$BC_{t,p} \in S_{t,p} \land \forall L \in S_{t,p}, L \preceq_{G,V,t} BC_{t,p} $$
	
\end{mydef}
\begin{myrem}
	Intuitively the blockchain for a user $p$ at a time $t$ is one of the best chain he fully knows regarding the protocol function and the validity at time $t$ (time-stamping).
\end{myrem}

\begin{mydef}
	Considering $LOG_{G,V}$ the set of validated chains with respect to $(G,V)$, $(P,K_T)$ a valid knowledge representation.
	We denote $\alpha^*$ the function $$ \mathbb{N} \times LOG_{G,V} \times P \rightarrow [0,1]$$ such that : 
	$$\alpha^*(\delta,L,p) = max\{\alpha | \exists b \in \B; (b,\alpha) \in K_T(p,T,\delta)\cap V(L)\} $$
	We said that $LOG_{G,V}$ is alive regarding $(P,K_T)$ if:
	$$\exists p \in P, \exists L \in LOG_{G,V}, L \subseteq K_T(p,T) \land K_T(p,T) \cap V(L) = \emptyset \land \lim\limits_{\delta\rightarrow +\infty} \alpha^*(\delta,L,p) = 1$$
\end{mydef}




\section{draft}
	
	\begin{mydef}
		Considering $(P,K_T)$ a valid knowledge representation, $LOG_{G,V}$ the set of validated chains with respect to $(G,V)$ alive, and $\preceq_{G,V}$ a block chain protocol. Let $L \in LOG_{G,V}$ we note 
		the probabilty that $L \subseteq B_{T+\delta,p}$  
	\end{mydef}
	
	
\begin{mydef}
	Considering $LOG_{G,V}$ the set of validated chains with respect to $(G,V)$, $(P,K_T)$ a valid knowledge representation. A block chain protocol $\preceq_{G,V,T}$ is said to be ageing-secured if
	\begin{eqnarray*}
		&\forall p \in P,\forall T_0 < T, \forall t,t' \leq T, B_{t,p} \subseteq B_{T_0,p}, B_{t',p} \subseteq B_{T_0,p} \\
		&t\leq t' \implies \forall T_1\geq T_0 , \mathbb{P}(B_{t,p}\subseteq B_{T_1,p}) \geq \mathbb{P}(B_{t',p}\subseteq B_{T_1,p})
	\end{eqnarray*}
\end{mydef}

