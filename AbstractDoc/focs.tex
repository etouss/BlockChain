\documentclass{article}


% \let\bfseriesbis=\bfseries \def\bfseries{\sffamily\bfseriesbis}
%
%
% \newenvironment{point}[1]%
% {\subsection*{#1}}%
% {}
%
% \setlength{\parskip}{0.3\baselineskip}


%% USEFUL packages
\usepackage{mypackages}

%% USEFUL macros
\input{mymacros}



%% Title
% \title{}
% \author{}
% \date{}

\begin{document}

% \sloppy
% \maketitle


\section{A Game-theoretic Characterization of Bitcoin Mining}

The mining game is played by a set $\bP = \{1, \ldots, m\}$ of players, with $m \geq 2$. In this game, each player has some reward depending on the number of blocks she owns. We denote by $\bB$ the set of all possible blocks, and we assume that there is a special block $\varepsilon \in \bB$ that is called the genesis block. Moreover, we associate the following functions to these blocks:
\begin{itemize}
\item $\owner : (\bB \setminus \{\varepsilon\}) \to \bP$: This function assigns an owner to each block, except for the genesis block that is assumed not to have an owner.

\item $\pred : (\B \setminus \{\varepsilon\}) \to \B$: This functions assigns a predecessor to each block, except for the genesis block that is the first block in every blockchain.
\end{itemize}
To give a game-theoretic characterization of bitcoin mining, we need to formalize the knowledge that each player has. More precisely, given a subset $q$ of $\bB$, define $\cG(q) = (N,E)$ as a graph satisfying that:
\begin{eqnarray*}
N &=& q\\
E &=& \{ (b_1,b_2) \in q^2 \mid \pred(b_2) = b_1\}
\end{eqnarray*}
Then $q$ is said to be a body of knowledge (of a player) if $\cG(q)$ is a tree rooted at $\varepsilon$ (in particular, $\varepsilon \in q$). If $q$ is a body of knowledge, then we use notation $\cT(q)$ instead of $\cG(q)$ to make explicit the fact that $\cG(q)$ is a tree.

Given a body of knowledge $q$, we say that the blockchain of $q$ is the longest path in $\cT(q)$ if such a path is unique, in which case we denote it by $\bchain(q)$. If two or more different paths are tied for the longest, then we say that the blockchain in $q$ does not exists, and we assume that $\bchain(q)$ is not defined (so that $\bchain(\cdot)$ is a partial function).

On each step, miners looking to maximise their rewards choose a block in the current body of knowledge, and attempt to mine from this block. Thus, in each turn, each of the players race to place the next block in the body of knowledge, and only one of them succeeds. The probability of succeeding is directly related to the comparative amount of hash power available to this player, the more hash power the likely it is that she will mine the next block before the rest of the players. Once a player places a block, this block is added to the current state, obtaining a different body of knowledge, and the game continues from this new state. 

Let $Q$ be the set of all possible bodies of knowledge, and let $\bQ = Q^m$. Each tuple $\bq = (q_1, \ldots, q_m)$ in $\bQ$ is a state of the mining game, where each component $q_p$ of $\bq$ is a body of knowledge that represents the knowledge of player $p$.

Given a player $p \in \bP$, a block $b \in \bB$ and bodies of knowledge $q, q' \in Q$, we denote by $\mine(p,b,q,q')$ the action played in the mining game, in which player $p$ mines block $b$, places this block in her current body of knowledge $q$ and decides to disclosure a portion $q'$ of $q$. Thus, action $\mine(p,b,q,q')$ is valid if:
\begin{itemize}
\item $\owner(b) = p$,

\item $b \not\in q$,

\item $\pred(b) \in q$, and

\item $q' \subseteq q \cup \{b\}$.
\end{itemize}
Notice that in the previous definition $q'$ is assumed to be a body of knowledge, so that the condition $q' \subseteq q \cup \{b\}$ is equivalent to the condition that $\cT(q')$ is a subtree of $\cT(q \cup \{b\})$ rooted at $\varepsilon$. Moreover, action $\mine(p,b,q,q')$ is said to be valid in a state $\bq = (q_1, \ldots, q_m)$ in $\bQ$ if $\mine(p,b,q,q')$ is a valid action and $q = q_p$.

Let $p \in \bP$ be a player, $\bx =  (x_1, \ldots, x_m)$ a state in $\bQ$ and $\mine(p,b,x_p,q)$ a valid action of $p$ in state $\bx$. Then the result of applying $\mine(p,b,x_p,q)$ to $\bx$ is a state $\by = (y_1, \ldots, y_m)$ in $\bQ$ such that:
\begin{itemize}
\item $y_p = x_p \cup \{b\}$, and

\item for every $i \in \{1, \ldots, m\}$ such that $i \neq p$, it holds that $y_i = x_i \cup q$.
\end{itemize}
In a full disclosure scenario all the allowed actions are of the form $\mine(p,b,q,q \cup \{b\})$, that is, all the information of player $p$ after placing $b$ in its body of knowledge is sent to the other players. In this case, we simplify the notation and use $\mine(p,b,q)$ instead of $\mine(p,b,q,q\cup \{b\})$.

Given a player $p \in \bP$, the set of actions for player $p$ is defined as:
\begin{eqnarray*}
\bA_p & = & \{ \mine(p,b,q,q') \mid \mine(p,b,q,q') \text{ is a valid action}\}.
\end{eqnarray*}
Given an action $a \in \bA_p$ and a state $\bq \in \bQ$ such that $a$ is a valid action in $\bq$, we use $a(\bq)$ to denote the state resulting of applying $a$ to $\bq$. Moreover, we denote by $\bA$ the set of all possible actions, that is, $\bA = \bA_1 \cup \cdots \cup \bA_m$.

Given a player $p \in \bP$ and a state $\bq \in \bQ$, the pay-off of player $p$ in $\bq$ is denoted by $r_p(\bq)$. Moreover, assuming that there is a  function $r_p$ for each player $p \in \bP$, define $\bR = (r_1, \ldots, r_m)$ as the pay-off function of the game.

Finally, we assume that the hash power of each player $p$ is given by a number $h_p \in (0,1)$ that represents the probability that player $p$ succeeds in placing the next block. Thus, we assume that:
\begin{eqnarray*}
\sum_{p=1}^m h_p & = &  1, 
\end{eqnarray*}and we define $\bH = (h_1, \ldots, h_m)$ as the hash power distribution.


Summing up, from now on we consider an infinite stochastic game $\Gamma = (\bP,\bA,\bQ,\bR,\bH)$ where:
\begin{itemize}
	\item $\bP$ is the set of player.
	\item $\bA$ is the set of possible actions.
	\item $\bQ$ is the set of states.
	\item $\bR$ is the pay-off function.
	\item $\bH$ is the hash power distribution.
\end{itemize} 


\subsection{Stationary equilibrium}
A strategy for a player $p \in \bP$ is a function $s : \bQ \rightarrow \bA_p$. 
We define $\bS_p$ as the set of all strategies for player $p$, and $\bS = \bS_{1} \times \bS_{2} \times \cdots \times \bS_{m}$ as the set of combined strategies for the game (recall that we are assuming that $\bP = \{1, \ldots, m\}$ is the set of players). 

Next we define a notion of how likely is reaching a state using a particular strategy, when starting at some specific state. Formally, given an initial state $\bq_0 \in \bQ$ and a strategy $\bs = (s_1, \ldots, s_m)$ in $\bS$, 
the probability of reaching state $\bq \in \bQ$ is recursively defined as follows:
\begin{eqnarray*}
\pr^{\bs}(\bq \mid \bq_0) & = &
\begin{cases}
0 & \text{if } |\bq| < |\bq_0|,\\
& \text{or if }  |\bq| = |\bq_0| \text{ and } \bq \neq \bq_0\\
&\\
1 & \text{if } \bq =  \bq_0\\
& \\
{\displaystyle \sum_{\substack{\bq' \in \bQ \,:\\ |\bq'| = k-1}} \pr^{\bs}(\bq' \mid \bq_0) \cdot \bigg(\sum_{\substack{p \in \{1, \ldots, m\} \,: \\ s_p(\bq') = a \text{ and } a(\bq') = \bq}} h_p\bigg)}
 & \text{if } |\bq| > |\bq_0| \text{ and } |\bq| = k
\end{cases}
\end{eqnarray*}
We finally have all the necessary ingredients to define the pay-off of a player in a mining game given a particular strategy.

\begin{mydef}
Let $p \in \bP$, $\bq_0 \in \bQ$, $\bs \in \bS$, $\beta \in [0,1]$ and $n \geq 0$. Then the $\beta$ discounted utility of player $p$ for the strategy $\bs$ from the state $\bq_0$ in a mining game with $n$ steps, denoted by $u_p^n(\bs \mid \bq_0)$, is defined as:
\begin{eqnarray*}
u_p^n(\bs \mid \bq_0) & = & \sum_{i=0}^{n}\beta^{i} \cdot  \bigg(\sum_{\bq \in \bQ \,:\, |\bq| = i} r_p(\bq) \cdot 
\pr^{\bs}(\bq \mid \bq_0)\bigg)
\end{eqnarray*}
Moreover, the $\beta$ discounted utility of player $p$ for the strategy $\bs$ from the state $\bq_0$ in an infinite mining game, denoted by $u_p(\bs \mid \bq_0)$, is defined as:
\begin{eqnarray*}
u_p(\bs \mid \bq_0) & = & \sum_{i=0}^{\infty}\beta^{i} \cdot  \bigg(\sum_{\bq \in \bQ \,:\, |\bq| = i} r_p(\bq) \cdot 
\pr^{\bs}(\bq \mid \bq_0)\bigg)
\end{eqnarray*}
\end{mydef}
Given a player $p \in \bP$, a combined strategy $\bs \in \bS$, with $\bs = (s_1, \ldots, s_m)$, and a strategy $s$ for player $p$ ($s \in \bS_p$), we denote by $(\bs_{-p}, s)$ the strategy $(s_1, \ldots s_{p-1},s,s_{p+1}, \ldots, s_{m})$.
\begin{mydef}
Let $\bq_0 \in \bQ$, $\bs \in \bS$, $\beta \in [0,1]$ and $n \geq 0$. Then $\bs$ is a $\beta$ discounted stationary equilibrium in a mining game with $n$ steps if for every player $p \in \bP$ and every strategy $s$ for player $p$ $(s \in\bS_p)$, it holds that:
\begin{eqnarray*}
u_p^n(\bs \mid \bq_0)  & \geq  & u_p^n((\bs_{-p},s) \mid \bq_0).
\end{eqnarray*}
Moreover, $\bs$ is a $\beta$ discounted stationary equilibrium  in  the infinite mining game if for every player $p \in \bP$ and every strategy $s$ for player $p$ $(s \in\bS_p)$, it holds that:
\begin{eqnarray*}u_p(\bs \mid \bq_0)  & \geq  & u_p ((\bs_{-p},s) \mid \bq_0).
\end{eqnarray*}
\end{mydef}



\section{Full Disclosure Scenario and Two Players}
In this section, we consider $\bP = \{1,2\}$, and we assume full disclosure of information between players.
For every state $\bq \in \bQ$ with $\bq = (q_1, \ldots, q_m)$, in this case it holds that $q_i = q_j$ for every $i,j \in \{1, \ldots, m\}$. Thus, in this section we simplify the notation and use a body of knowledge $q$ to represent a state of the game, instead of a tuple $\bq$ of the form $(q, \ldots, q)$.

For $p \in \{1,2\}$, we define the indicator  function $\chi_p : \bB \to \{0,1\}$ as follows:
\begin{eqnarray*}
\chi_p(b) & = & 
\begin{cases}
1 & \owner(b) = p\\
0 & \text{otherwise}
\end{cases}
\end{eqnarray*}

Given a body of knowledge $q$ such that $\bchain(q)$ is defined, the length of path $\bchain(q)$ is defined as the number of edges in $\bchain(q)$, and it is denoted by $|\bchain(q)|$. Moreover, given $i \in \{0, \ldots, |\bchain(q)|\}$, we use $\bchain(q,i)$ to denote the $i$-th block in the path $\bchain(q)$.


\subsection{Constant Reward}
For a player $p \in \bP$, its reward $r_p(q)$ is defined as:
\begin{eqnarray*}
r_p(q) & = & 
\begin{cases}
0 & \text{if } \bchain(q) \text{ is not defined}\\
{\displaystyle c \cdot \sum_{i=0}^{|\bchain(q)|} \chi_p(\bchain(q,i))} & \text{otherwise}
\end{cases}
\end{eqnarray*}






\end{document}